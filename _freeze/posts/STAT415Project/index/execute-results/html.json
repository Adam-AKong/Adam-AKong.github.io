{
  "hash": "c331c08309b972d7c3f07022463ad3f7",
  "result": {
    "markdown": "---\ntitle: \"2023 Basketball Bayesian Analysis\"\nauthor: \"Adam Kong\"\ndate: \"2024-06-24\"\ncategories: [Projects]\nimage: body.png\n---\n\n\n\n\nOur research question investigates how usage rate (USG) and minutes played per game (MP) affect an NBA player’s annual salary for the 2022-23 season. Usage rate is the percentage of a team’s possessions a player ends while on the court. It's calculated by adding up a player's field goal attempts, turnovers, and trips to the free throw line, and then dividing that by the team's total of those plays when the player is on the court. Minutes played per game describes how many in-game minutes (there are 48 in-game minutes in a regular NBA game) a player averages per game.\n\nThis data set contains numerous variables for players in the NBA. We are using USG and MP (as well as their interaction) as explanatory variables and log(Salary) as the response variable.\n\nThe data set includes numerous variables for NBA players during the 2022-23 season. We decided to focus on the usage rate and minutes played per game statistics and how that affects a player’s salary. The data is publicly available because players’ salaries are reported by agents and reporters and in-game stats are often released by NBA stat keepers. Kaggle (where we got the data from) compiled the data set from numerous websites and databases.\n\n# Pre-Bayesian Analysis\n\nAs seen below these explanatory variables are not very normal. However, we went into our analysis by transforming the response variable of salaries since salaries are much more likely to be skewed to the right without previous insepction of the dataset, since a few select players will have extreme salaries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\nplot(nba_salary$USG., nba_salary$Salary)\nplot(nba_salary$MP, nba_salary$Salary)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nPossible transformations and inspection of data before analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nhist(nba_salary$Salary)\nhist(sqrt(nba_salary$Salary))\nhist(log(nba_salary$Salary))\nhist(nba_salary$Salary/1000000)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n# Proposed Bayesian Model\n\n$${\\log(Y)} = {\\beta_0} + {\\beta_1}(USG) + {\\beta_2}(MP) + {\\beta_3}(USG*MP) + {\\varepsilon}$$\n\n# Choice of Likelihood\n\nWe used a Normal likelihood to calculate the probability of observing a certain log(Salary) given certain parameters for the betas.\n\n# Assumptions\n\nLinearity: The relationship between log(Salary) and the explanatory variables is linear Homoscedasticity: variance of the residuals is constant Independence of errors: Residuals are independent of each other Normally distributed: Residuals are approximately normally distributed Independence of independent variables: included interaction effect in model to see how variables interact with each other.\n\n# Bayesian Model Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_01 <- lm(log(Salary) ~ MP + USG. + MP*USG., data = nba_salary)\nsummary(test_01)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log(Salary) ~ MP + USG. + MP * USG., data = nba_salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-7.8611 -0.5311  0.2033  0.7138  2.7588 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 14.1414029  0.3791128  37.301  < 2e-16 ***\nMP           0.0272010  0.0179315   1.517   0.1300    \nUSG.        -0.0485190  0.0197029  -2.463   0.0142 *  \nMP:USG.      0.0033111  0.0008146   4.065 5.65e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.191 on 463 degrees of freedom\nMultiple R-squared:  0.4103,\tAdjusted R-squared:  0.4064 \nF-statistic: 107.4 on 3 and 463 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(test_01)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nWe used BRMS to choose a prior distribution for the data. The model chose a student_t(3, 15.1, 2.5) distribution for the intercept and a student_t(3, 0, 2.5) distribution for sigma. The MP and USG variables have a flat prior, which is an improper distribution, but one that makes no assumption of the distribution.\n\n# BRMS Chosen Prior\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_prior(data = nba_salary,\n          family = gaussian(),\n          log(Salary) ~ MP + USG. + MP*USG.)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   prior     class    coef group resp dpar nlpar lb ub\n                  (flat)         b                                    \n                  (flat)         b      MP                            \n                  (flat)         b MP:USG.                            \n                  (flat)         b    USG.                            \n student_t(3, 15.1, 2.5) Intercept                                    \n    student_t(3, 0, 2.5)     sigma                                0   \n       source\n      default\n (vectorized)\n (vectorized)\n (vectorized)\n      default\n      default\n```\n:::\n:::\n\n\n# BRMS (First Model)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- brm(data = nba_salary,\n           family = gaussian(),\n           log(Salary) ~ MP + USG. + MP*USG.,\n           sample_prior = TRUE,\n           iter = 3500,\n           warmup = 1000,\n           chains = 4,\n           refresh = 0)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCompiling Stan program...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nStart sampling\n```\n:::\n:::\n\n\n# BRMS Posterior Output Analysis\n\nThe posterior distribution does not change very much if the prior changes. This is because we have a large sample size for our data, which means that the data is going to hold the most weight in the posterior distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolor_scheme_set(\"viridis\")\n\nplot(fit)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: log(Salary) ~ MP + USG. + MP * USG. \n   Data: nba_salary (Number of observations: 467) \n  Draws: 4 chains, each with iter = 3500; warmup = 1000; thin = 1;\n         total post-warmup draws = 10000\n\nRegression Coefficients:\n          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nIntercept    14.14      0.38    13.41    14.89 1.00     4248     4638\nMP            0.03      0.02    -0.01     0.06 1.00     4643     5399\nUSG.         -0.05      0.02    -0.09    -0.01 1.00     4372     5098\nMP:USG.       0.00      0.00     0.00     0.00 1.00     4436     4666\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     1.19      0.04     1.12     1.27 1.00     6379     5220\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n:::\n:::\n\n\nNote, that we did run an interaction between minutes played and player usage. We decided to keep that in when simulated because before simulation we found that the interaction was significant, but now it was not in the posterior. We did not find this out until after the simulation was ran, but we kept because it's notable that minutes played and usage, while correlated, it's interaction was not significant to the log salary.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolor_scheme_set(\"purple\")\n\npp_check(fit, ndraw = 100)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nSimulated distributions follow a similar distribution with the actual curve. The actual curve has some strange curves due to the salary.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npairs(fit)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nFrom this plot we can see that minutes played has a positive correlation with the usage rate. This is expected as generally players with a high minutes played will have a larger usage rate.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmcmc_dens_overlay(fit, pars = vars(b_Intercept, b_MP, b_USG., sigma))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nLooking good so far! The chains are very close to each other here.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nneff_ratio(fit)[c(\"b_Intercept\", \"b_MP\", \"b_USG.\", \"sigma\")]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nb_Intercept        b_MP      b_USG.       sigma \n  0.4247532   0.4642651   0.4372386   0.5219679 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nneff_ratio(fit)[c(\"b_Intercept\", \"b_MP\", \"b_USG.\", \"sigma\")] |> \n  mcmc_neff() +\n  yaxis_text(hjust = 0) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nLooks good.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmcmc_intervals(fit,\n               pars = c(\"b_MP\"),\n               prob = 0.5,\n               prob_outer = 0.98)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nMP is a positive coefficent, just like before the simulation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolor_scheme_set(\"teal\")\n\nmcmc_areas(fit,\n           pars = c(\"b_MP\"),\n           prob = 0.5,\n           point_est = \"median\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmcmc_areas(fit,\n           pars = c(\"b_MP\"),\n           prob = 0.8,\n           point_est = \"median\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n\n```{.r .cell-code}\nmcmc_areas(fit,\n           pars = c(\"b_MP\"),\n           prob = 0.98,\n           point_est = \"median\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-3.png){width=672}\n:::\n:::\n\n\nPossibly may have some negative simulated values, but more positive.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmcmc_intervals(fit,\n               pars = c(\"b_USG.\"),\n               prob = 0.5,\n               prob_outer = 0.98)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nSurprisingly the coefficient for Usage is negative. Not very strong as usage has a range from 0 to 100, and most players have below 50 so not as big of an effect.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolor_scheme_set(\"teal\")\n\nmcmc_areas(fit,\n           pars = c(\"b_USG.\"),\n           prob = 0.5,\n           point_est = \"median\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmcmc_areas(fit,\n           pars = c(\"b_USG.\"),\n           prob = 0.8,\n           point_est = \"median\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n\n```{.r .cell-code}\nmcmc_areas(fit,\n           pars = c(\"b_USG.\"),\n           prob = 0.98,\n           point_est = \"median\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior = fit |>\n  spread_draws(b_Intercept, sigma)\n\nposterior |> head(10) |> kbl() |> kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> .chain </th>\n   <th style=\"text-align:right;\"> .iteration </th>\n   <th style=\"text-align:right;\"> .draw </th>\n   <th style=\"text-align:right;\"> b_Intercept </th>\n   <th style=\"text-align:right;\"> sigma </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 13.93006 </td>\n   <td style=\"text-align:right;\"> 1.170048 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 14.02398 </td>\n   <td style=\"text-align:right;\"> 1.143928 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 14.19821 </td>\n   <td style=\"text-align:right;\"> 1.210008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 13.87291 </td>\n   <td style=\"text-align:right;\"> 1.177849 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 14.62475 </td>\n   <td style=\"text-align:right;\"> 1.207042 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 14.61113 </td>\n   <td style=\"text-align:right;\"> 1.208182 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 13.71179 </td>\n   <td style=\"text-align:right;\"> 1.202079 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 13.28116 </td>\n   <td style=\"text-align:right;\"> 1.162212 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 14.10877 </td>\n   <td style=\"text-align:right;\"> 1.172498 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 14.37647 </td>\n   <td style=\"text-align:right;\"> 1.240193 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_mean = fit |>\n  spread_draws(b_Intercept) |>\n  rename(Intercept_y = b_Intercept)\n\nposterior_mean |> head(10) |> kbl() |> kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> .chain </th>\n   <th style=\"text-align:right;\"> .iteration </th>\n   <th style=\"text-align:right;\"> .draw </th>\n   <th style=\"text-align:right;\"> Intercept_y </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 13.93006 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 14.02398 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 14.19821 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 13.87291 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 14.62475 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 14.61113 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 13.71179 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 13.28116 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 14.10877 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 14.37647 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_sigma = fit |>\n  spread_draws(sigma) |>\n  rename(sigma_y = sigma)\n\nposterior_sigma |> head(10) |> kbl() |> kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> .chain </th>\n   <th style=\"text-align:right;\"> .iteration </th>\n   <th style=\"text-align:right;\"> .draw </th>\n   <th style=\"text-align:right;\"> sigma_y </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1.170048 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1.143928 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1.210008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1.177849 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 1.207042 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 1.208182 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 1.202079 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 1.162212 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 1.172498 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 1.240193 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Posterior Population Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile(posterior$b_Intercept, c(0.01, 0.10, 0.25, 0.50, 0.75, 0.90, 0.99))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      1%      10%      25%      50%      75%      90%      99% \n13.26899 13.66008 13.87919 14.13453 14.39805 14.62570 15.02639 \n```\n:::\n:::\n\n\nThere is a 50% chance that the population mean salary is between $e^{13.87}$ and $e^{14.38}$ dollars. There is an 80% chance that the population mean salary is between $e^{13.63}$ and $e^{14.64}$ dollars. There is a 98% chance that the population mean salary is between $e^{13.23}$ and $e^{15.04}$ dollars.\n\n$e^{13.23}$ is roughly around 556,821.5 dollars and $e^{15.04}$ is roughly around 3,402,429 dollars\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile(posterior$sigma, c(0.01, 0.10, 0.25, 0.50, 0.75, 0.90, 0.99))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      1%      10%      25%      50%      75%      90%      99% \n1.106558 1.143666 1.166100 1.192325 1.218613 1.243518 1.286120 \n```\n:::\n:::\n\n\nThere is a 50% chance that the population SD of salary is between $e^{1.17}$ and $e^{1.22}$ dollars. There is an 80% chance that the population SD of salary is between $e^{1.14}$ and $e^{1.25}$ dollars. There is an 98% chance that the population SD of salary is between $e^{1.11}$ and $e^{1.29}$ dollars.\n\n$e^{1.11}$ is roughly around 3.03 dollars and $e^{1.29}$ is roughly around 3.63 dollars. This is a little strange, but since we transformed our response, the standard deviation likely wasn't as varied transformed.\n\n# Stephen Curry Posterior Analysis (Model 1)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_steph = fit |>\n  spread_draws(b_Intercept, b_MP, b_USG., `b_MP:USG.`, sigma) |>\n  mutate(Steph_y = b_Intercept + \n           b_MP * 34.7 + \n           b_USG. * 31.0 + \n           `b_MP:USG.` * 34.7 * 31.0)\n\nposterior_steph |> head(10) |> kbl() |> kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> .chain </th>\n   <th style=\"text-align:right;\"> .iteration </th>\n   <th style=\"text-align:right;\"> .draw </th>\n   <th style=\"text-align:right;\"> b_Intercept </th>\n   <th style=\"text-align:right;\"> b_MP </th>\n   <th style=\"text-align:right;\"> b_USG. </th>\n   <th style=\"text-align:right;\"> b_MP:USG. </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> Steph_y </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 13.93006 </td>\n   <td style=\"text-align:right;\"> 0.0370065 </td>\n   <td style=\"text-align:right;\"> -0.0493851 </td>\n   <td style=\"text-align:right;\"> 0.0033027 </td>\n   <td style=\"text-align:right;\"> 1.170048 </td>\n   <td style=\"text-align:right;\"> 17.23599 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 14.02398 </td>\n   <td style=\"text-align:right;\"> 0.0171735 </td>\n   <td style=\"text-align:right;\"> -0.0462256 </td>\n   <td style=\"text-align:right;\"> 0.0039307 </td>\n   <td style=\"text-align:right;\"> 1.143928 </td>\n   <td style=\"text-align:right;\"> 17.41518 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 14.19821 </td>\n   <td style=\"text-align:right;\"> 0.0382640 </td>\n   <td style=\"text-align:right;\"> -0.0635444 </td>\n   <td style=\"text-align:right;\"> 0.0032073 </td>\n   <td style=\"text-align:right;\"> 1.210008 </td>\n   <td style=\"text-align:right;\"> 17.00620 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 13.87291 </td>\n   <td style=\"text-align:right;\"> 0.0388952 </td>\n   <td style=\"text-align:right;\"> -0.0278952 </td>\n   <td style=\"text-align:right;\"> 0.0026233 </td>\n   <td style=\"text-align:right;\"> 1.177849 </td>\n   <td style=\"text-align:right;\"> 17.17972 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 14.62475 </td>\n   <td style=\"text-align:right;\"> -0.0037177 </td>\n   <td style=\"text-align:right;\"> -0.0744778 </td>\n   <td style=\"text-align:right;\"> 0.0046737 </td>\n   <td style=\"text-align:right;\"> 1.207042 </td>\n   <td style=\"text-align:right;\"> 17.21441 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 14.61113 </td>\n   <td style=\"text-align:right;\"> -0.0035954 </td>\n   <td style=\"text-align:right;\"> -0.0732371 </td>\n   <td style=\"text-align:right;\"> 0.0046510 </td>\n   <td style=\"text-align:right;\"> 1.208182 </td>\n   <td style=\"text-align:right;\"> 17.21910 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 13.71179 </td>\n   <td style=\"text-align:right;\"> 0.0440438 </td>\n   <td style=\"text-align:right;\"> -0.0294713 </td>\n   <td style=\"text-align:right;\"> 0.0027034 </td>\n   <td style=\"text-align:right;\"> 1.202079 </td>\n   <td style=\"text-align:right;\"> 17.23456 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 13.28116 </td>\n   <td style=\"text-align:right;\"> 0.0675191 </td>\n   <td style=\"text-align:right;\"> -0.0065154 </td>\n   <td style=\"text-align:right;\"> 0.0015795 </td>\n   <td style=\"text-align:right;\"> 1.162212 </td>\n   <td style=\"text-align:right;\"> 17.12118 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 14.10877 </td>\n   <td style=\"text-align:right;\"> 0.0239218 </td>\n   <td style=\"text-align:right;\"> -0.0450594 </td>\n   <td style=\"text-align:right;\"> 0.0033476 </td>\n   <td style=\"text-align:right;\"> 1.172498 </td>\n   <td style=\"text-align:right;\"> 17.14304 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 14.37647 </td>\n   <td style=\"text-align:right;\"> 0.0260230 </td>\n   <td style=\"text-align:right;\"> -0.0637439 </td>\n   <td style=\"text-align:right;\"> 0.0035893 </td>\n   <td style=\"text-align:right;\"> 1.240193 </td>\n   <td style=\"text-align:right;\"> 17.16445 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_steph |>\n  ggplot(aes(x = Steph_y)) +\n  stat_halfeye(.width = c(0.80, 0.98),\n               fill = bayes_col[\"posterior\"]) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile(posterior_steph$Steph_y, c(0.01, 0.10, 0.25, 0.50, 0.75, 0.90, 0.99))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      1%      10%      25%      50%      75%      90%      99% \n16.75231 16.92697 17.03057 17.14424 17.25532 17.36493 17.53746 \n```\n:::\n:::\n\n\nThere is a 50% chance that the salary of a player with Stephen Curry’s USG and MP is between $e^{17.031}$ and $e^{17.258}$ dollars. There is an 80% chance that the salary of a player with Stephen Curry’s USG and MP is between $e^{16.926}$ and $e^{17.361}$ dollars. There is a 98% chance that the salary of a player with Stephen Curry’s USG and MP is between $e^{16.747}$ and $e^{17.533}$ dollars.\n\nIn other words for the 98% credible interval, there is a 98% chance that the salary of a player with Stephen Curry’s USG and MP is between 18,755,545 and 41,160,927 dollars. This is a really accurate prediction, especially since Stephen Curry's salaries is the highest in the data set.\n\n# Davion Mitchell Posterior Analysis (Model 1)\n\nWe then inspected a player in the middle of the list, Davion Mitchell who plays a decent amount of games and is a reasonably average NBA player to analyze.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_davion = fit |>\n  spread_draws(b_Intercept, b_MP, b_USG., `b_MP:USG.`, sigma) |>\n  mutate(Davion_y = b_Intercept + \n           b_MP * 14.1 + \n           b_USG. * 31.0 + \n           `b_MP:USG.` * 14.1 * 31.0)\n\nposterior_davion |> head(10) |> kbl() |> kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> .chain </th>\n   <th style=\"text-align:right;\"> .iteration </th>\n   <th style=\"text-align:right;\"> .draw </th>\n   <th style=\"text-align:right;\"> b_Intercept </th>\n   <th style=\"text-align:right;\"> b_MP </th>\n   <th style=\"text-align:right;\"> b_USG. </th>\n   <th style=\"text-align:right;\"> b_MP:USG. </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> Davion_y </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 13.93006 </td>\n   <td style=\"text-align:right;\"> 0.0370065 </td>\n   <td style=\"text-align:right;\"> -0.0493851 </td>\n   <td style=\"text-align:right;\"> 0.0033027 </td>\n   <td style=\"text-align:right;\"> 1.170048 </td>\n   <td style=\"text-align:right;\"> 14.36454 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 14.02398 </td>\n   <td style=\"text-align:right;\"> 0.0171735 </td>\n   <td style=\"text-align:right;\"> -0.0462256 </td>\n   <td style=\"text-align:right;\"> 0.0039307 </td>\n   <td style=\"text-align:right;\"> 1.143928 </td>\n   <td style=\"text-align:right;\"> 14.55125 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 14.19821 </td>\n   <td style=\"text-align:right;\"> 0.0382640 </td>\n   <td style=\"text-align:right;\"> -0.0635444 </td>\n   <td style=\"text-align:right;\"> 0.0032073 </td>\n   <td style=\"text-align:right;\"> 1.210008 </td>\n   <td style=\"text-align:right;\"> 14.16977 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 13.87291 </td>\n   <td style=\"text-align:right;\"> 0.0388952 </td>\n   <td style=\"text-align:right;\"> -0.0278952 </td>\n   <td style=\"text-align:right;\"> 0.0026233 </td>\n   <td style=\"text-align:right;\"> 1.177849 </td>\n   <td style=\"text-align:right;\"> 14.70324 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 14.62475 </td>\n   <td style=\"text-align:right;\"> -0.0037177 </td>\n   <td style=\"text-align:right;\"> -0.0744778 </td>\n   <td style=\"text-align:right;\"> 0.0046737 </td>\n   <td style=\"text-align:right;\"> 1.207042 </td>\n   <td style=\"text-align:right;\"> 14.30638 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 14.61113 </td>\n   <td style=\"text-align:right;\"> -0.0035954 </td>\n   <td style=\"text-align:right;\"> -0.0732371 </td>\n   <td style=\"text-align:right;\"> 0.0046510 </td>\n   <td style=\"text-align:right;\"> 1.208182 </td>\n   <td style=\"text-align:right;\"> 14.32304 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 13.71179 </td>\n   <td style=\"text-align:right;\"> 0.0440438 </td>\n   <td style=\"text-align:right;\"> -0.0294713 </td>\n   <td style=\"text-align:right;\"> 0.0027034 </td>\n   <td style=\"text-align:right;\"> 1.202079 </td>\n   <td style=\"text-align:right;\"> 14.60086 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 13.28116 </td>\n   <td style=\"text-align:right;\"> 0.0675191 </td>\n   <td style=\"text-align:right;\"> -0.0065154 </td>\n   <td style=\"text-align:right;\"> 0.0015795 </td>\n   <td style=\"text-align:right;\"> 1.162212 </td>\n   <td style=\"text-align:right;\"> 14.72161 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 14.10877 </td>\n   <td style=\"text-align:right;\"> 0.0239218 </td>\n   <td style=\"text-align:right;\"> -0.0450594 </td>\n   <td style=\"text-align:right;\"> 0.0033476 </td>\n   <td style=\"text-align:right;\"> 1.172498 </td>\n   <td style=\"text-align:right;\"> 14.51247 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 14.37647 </td>\n   <td style=\"text-align:right;\"> 0.0260230 </td>\n   <td style=\"text-align:right;\"> -0.0637439 </td>\n   <td style=\"text-align:right;\"> 0.0035893 </td>\n   <td style=\"text-align:right;\"> 1.240193 </td>\n   <td style=\"text-align:right;\"> 14.33623 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_davion |>\n  ggplot(aes(x = Davion_y)) +\n  stat_halfeye(.width = c(0.80, 0.98),\n               fill = bayes_col[\"posterior\"]) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile(posterior_davion$Davion_y, c(0.01, 0.10, 0.25, 0.50, 0.75, 0.90, 0.99))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      1%      10%      25%      50%      75%      90%      99% \n14.06535 14.25147 14.35474 14.46883 14.58527 14.69119 14.87951 \n```\n:::\n:::\n\n\nThere is a 50% chance that the salary of a player with Davion Mitchell’s USG and MP is between $e^{14.354}$ and $e^{14.590}$ dollars. There is an 80% chance that the salary of a player with Davion Mitchell’s USG and MP is between $e^{14.250}$ and $e^{14.698}$ dollars. There is a 98% chance that the salary of a player with Davion Mitchell’s USG and MP is between $e^{14.070}$ and $e^{14.866}$ dollars.\n\nFor the 98% credible interval, there is a 98% chance that the salary of a player with Davion Mitchell’s USG and MP is between 1,289,803 and 2,859,050 dollars. This is a pretty accurate prediction to his actual salary.\n\n# BRMS (Model 2)\n\nWe did another analysis below for both Stephen Curry and Davion Mitchell. We saw that Davion Mitchell had a lot more games played than Stephen Curry but had significantly lower pay. We wanted to see if games played had more of an effect on players like Davion, but would not players with higher stats like Curry.\n\nWill only look at the 98% credible interval for this analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_02 <- lm(log(Salary) ~ MP + USG. + GP + MP*USG., data = nba_salary)\nsummary(test_02)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log(Salary) ~ MP + USG. + GP + MP * USG., data = nba_salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-5.8219 -0.6882  0.0414  0.6706  3.6089 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 13.7403724  0.3433410  40.020  < 2e-16 ***\nMP          -0.0377184  0.0172884  -2.182   0.0296 *  \nUSG.        -0.0441375  0.0177373  -2.488   0.0132 *  \nGP           0.0278838  0.0026632  10.470  < 2e-16 ***\nMP:USG.      0.0039952  0.0007361   5.428 9.24e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.072 on 462 degrees of freedom\nMultiple R-squared:  0.5233,\tAdjusted R-squared:  0.5192 \nF-statistic: 126.8 on 4 and 462 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(test_02)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_2 <- brm(data = nba_salary,\n           family = gaussian(),\n           log(Salary) ~ MP + USG. + GP + MP*USG.,\n           sample_prior = TRUE,\n           iter = 3500,\n           warmup = 1000,\n           chains = 4,\n           refresh = 0)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCompiling Stan program...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nStart sampling\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: log(Salary) ~ MP + USG. + GP + MP * USG. \n   Data: nba_salary (Number of observations: 467) \n  Draws: 4 chains, each with iter = 3500; warmup = 1000; thin = 1;\n         total post-warmup draws = 10000\n\nRegression Coefficients:\n          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nIntercept    13.74      0.35    13.07    14.42 1.00     4531     5808\nMP           -0.04      0.02    -0.07    -0.00 1.00     4528     5541\nUSG.         -0.04      0.02    -0.08    -0.01 1.00     4761     5953\nGP            0.03      0.00     0.02     0.03 1.00     8467     7271\nMP:USG.       0.00      0.00     0.00     0.01 1.00     4451     5751\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     1.07      0.04     1.01     1.15 1.00     6798     6487\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolor_scheme_set(\"purple\")\n\npp_check(fit_2, ndraw = 100)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\nA little more off than model 1 ppcheck.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npairs(fit_2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\nFrom this plot we can see that minutes played still has a positive correlation with the usage rate. Both minutes played and usage rate is independent of games played.\n\n# Stephen Curry Posterior Analysis (Model 2)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_steph_2 = fit_2 |>\n  spread_draws(b_Intercept, b_MP, b_USG., b_GP, `b_MP:USG.`, sigma) |>\n  mutate(Steph_y = b_Intercept + \n           b_MP * 34.7 + \n           b_USG. * 31.0 + \n           b_GP * 56 +\n           `b_MP:USG.` * 34.7 * 31.0)\n\nposterior_steph_2 |> head(10) |> kbl() |> kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> .chain </th>\n   <th style=\"text-align:right;\"> .iteration </th>\n   <th style=\"text-align:right;\"> .draw </th>\n   <th style=\"text-align:right;\"> b_Intercept </th>\n   <th style=\"text-align:right;\"> b_MP </th>\n   <th style=\"text-align:right;\"> b_USG. </th>\n   <th style=\"text-align:right;\"> b_GP </th>\n   <th style=\"text-align:right;\"> b_MP:USG. </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> Steph_y </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 13.49536 </td>\n   <td style=\"text-align:right;\"> -0.0244795 </td>\n   <td style=\"text-align:right;\"> -0.0286339 </td>\n   <td style=\"text-align:right;\"> 0.0265672 </td>\n   <td style=\"text-align:right;\"> 0.0034560 </td>\n   <td style=\"text-align:right;\"> 1.104117 </td>\n   <td style=\"text-align:right;\"> 16.96370 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 14.19783 </td>\n   <td style=\"text-align:right;\"> -0.0642514 </td>\n   <td style=\"text-align:right;\"> -0.0664605 </td>\n   <td style=\"text-align:right;\"> 0.0286436 </td>\n   <td style=\"text-align:right;\"> 0.0050852 </td>\n   <td style=\"text-align:right;\"> 1.064857 </td>\n   <td style=\"text-align:right;\"> 16.98220 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 13.83181 </td>\n   <td style=\"text-align:right;\"> -0.0405200 </td>\n   <td style=\"text-align:right;\"> -0.0542585 </td>\n   <td style=\"text-align:right;\"> 0.0287102 </td>\n   <td style=\"text-align:right;\"> 0.0044288 </td>\n   <td style=\"text-align:right;\"> 1.057402 </td>\n   <td style=\"text-align:right;\"> 17.11557 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 13.91159 </td>\n   <td style=\"text-align:right;\"> -0.0210095 </td>\n   <td style=\"text-align:right;\"> -0.0533979 </td>\n   <td style=\"text-align:right;\"> 0.0239638 </td>\n   <td style=\"text-align:right;\"> 0.0038592 </td>\n   <td style=\"text-align:right;\"> 1.042943 </td>\n   <td style=\"text-align:right;\"> 17.02054 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 13.64288 </td>\n   <td style=\"text-align:right;\"> -0.0330182 </td>\n   <td style=\"text-align:right;\"> -0.0337974 </td>\n   <td style=\"text-align:right;\"> 0.0264381 </td>\n   <td style=\"text-align:right;\"> 0.0037901 </td>\n   <td style=\"text-align:right;\"> 1.079796 </td>\n   <td style=\"text-align:right;\"> 17.00698 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 13.50358 </td>\n   <td style=\"text-align:right;\"> -0.0324451 </td>\n   <td style=\"text-align:right;\"> -0.0336407 </td>\n   <td style=\"text-align:right;\"> 0.0264968 </td>\n   <td style=\"text-align:right;\"> 0.0040996 </td>\n   <td style=\"text-align:right;\"> 1.079482 </td>\n   <td style=\"text-align:right;\"> 17.22863 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 13.54291 </td>\n   <td style=\"text-align:right;\"> -0.0335147 </td>\n   <td style=\"text-align:right;\"> -0.0340889 </td>\n   <td style=\"text-align:right;\"> 0.0301641 </td>\n   <td style=\"text-align:right;\"> 0.0035574 </td>\n   <td style=\"text-align:right;\"> 1.081017 </td>\n   <td style=\"text-align:right;\"> 16.83906 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 13.91689 </td>\n   <td style=\"text-align:right;\"> -0.0436091 </td>\n   <td style=\"text-align:right;\"> -0.0505774 </td>\n   <td style=\"text-align:right;\"> 0.0263818 </td>\n   <td style=\"text-align:right;\"> 0.0043637 </td>\n   <td style=\"text-align:right;\"> 1.053566 </td>\n   <td style=\"text-align:right;\"> 17.00722 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 13.90655 </td>\n   <td style=\"text-align:right;\"> -0.0440917 </td>\n   <td style=\"text-align:right;\"> -0.0553922 </td>\n   <td style=\"text-align:right;\"> 0.0297604 </td>\n   <td style=\"text-align:right;\"> 0.0043289 </td>\n   <td style=\"text-align:right;\"> 1.025806 </td>\n   <td style=\"text-align:right;\"> 16.98257 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 13.78923 </td>\n   <td style=\"text-align:right;\"> -0.0493760 </td>\n   <td style=\"text-align:right;\"> -0.0417026 </td>\n   <td style=\"text-align:right;\"> 0.0296250 </td>\n   <td style=\"text-align:right;\"> 0.0042616 </td>\n   <td style=\"text-align:right;\"> 1.039411 </td>\n   <td style=\"text-align:right;\"> 17.02629 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_steph_2 |>\n  ggplot(aes(x = Steph_y)) +\n  stat_halfeye(.width = c(0.80, 0.98),\n               fill = bayes_col[\"posterior\"]) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile(posterior_steph_2$Steph_y, c(0.01, 0.99))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      1%      99% \n16.56222 17.27539 \n```\n:::\n:::\n\n\nThere is a 98% chance that the salary of a player with Stephen Curry’s USG, MP, and GP is between $e^{16.56}$ and $e^{17.29}$ dollars.\n\nThere is a 98% chance that a player with Stephen Curry's stats will have a predicted salary of 15,556,669 to 32,130,940 dollars. This seems more incorrect as Curry has a salary closer to 40 million dollars, but reasonable when it comes to number of games played. Curry is an outlier in terms of salary, so this prediction makes sense.\n\n# Davion Mitchell Posterior Analysis (Model 2)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_davion_2 = fit_2 |>\n  spread_draws(b_Intercept, b_MP, b_USG., b_GP, `b_MP:USG.`, sigma) |>\n  mutate(Davion_y = b_Intercept + \n           b_MP * 14.1 + \n           b_USG. * 31.0 + \n           b_GP * 80 +\n           `b_MP:USG.` * 14.1 * 31.0)\n\nposterior_davion_2 |> head(10) |> kbl() |> kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> .chain </th>\n   <th style=\"text-align:right;\"> .iteration </th>\n   <th style=\"text-align:right;\"> .draw </th>\n   <th style=\"text-align:right;\"> b_Intercept </th>\n   <th style=\"text-align:right;\"> b_MP </th>\n   <th style=\"text-align:right;\"> b_USG. </th>\n   <th style=\"text-align:right;\"> b_GP </th>\n   <th style=\"text-align:right;\"> b_MP:USG. </th>\n   <th style=\"text-align:right;\"> sigma </th>\n   <th style=\"text-align:right;\"> Davion_y </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 13.49536 </td>\n   <td style=\"text-align:right;\"> -0.0244795 </td>\n   <td style=\"text-align:right;\"> -0.0286339 </td>\n   <td style=\"text-align:right;\"> 0.0265672 </td>\n   <td style=\"text-align:right;\"> 0.0034560 </td>\n   <td style=\"text-align:right;\"> 1.104117 </td>\n   <td style=\"text-align:right;\"> 15.89856 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 14.19783 </td>\n   <td style=\"text-align:right;\"> -0.0642514 </td>\n   <td style=\"text-align:right;\"> -0.0664605 </td>\n   <td style=\"text-align:right;\"> 0.0286436 </td>\n   <td style=\"text-align:right;\"> 0.0050852 </td>\n   <td style=\"text-align:right;\"> 1.064857 </td>\n   <td style=\"text-align:right;\"> 15.74583 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 13.83181 </td>\n   <td style=\"text-align:right;\"> -0.0405200 </td>\n   <td style=\"text-align:right;\"> -0.0542585 </td>\n   <td style=\"text-align:right;\"> 0.0287102 </td>\n   <td style=\"text-align:right;\"> 0.0044288 </td>\n   <td style=\"text-align:right;\"> 1.057402 </td>\n   <td style=\"text-align:right;\"> 15.81110 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 13.91159 </td>\n   <td style=\"text-align:right;\"> -0.0210095 </td>\n   <td style=\"text-align:right;\"> -0.0533979 </td>\n   <td style=\"text-align:right;\"> 0.0239638 </td>\n   <td style=\"text-align:right;\"> 0.0038592 </td>\n   <td style=\"text-align:right;\"> 1.042943 </td>\n   <td style=\"text-align:right;\"> 15.56398 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 13.64288 </td>\n   <td style=\"text-align:right;\"> -0.0330182 </td>\n   <td style=\"text-align:right;\"> -0.0337974 </td>\n   <td style=\"text-align:right;\"> 0.0264381 </td>\n   <td style=\"text-align:right;\"> 0.0037901 </td>\n   <td style=\"text-align:right;\"> 1.079796 </td>\n   <td style=\"text-align:right;\"> 15.90131 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 13.50358 </td>\n   <td style=\"text-align:right;\"> -0.0324451 </td>\n   <td style=\"text-align:right;\"> -0.0336407 </td>\n   <td style=\"text-align:right;\"> 0.0264968 </td>\n   <td style=\"text-align:right;\"> 0.0040996 </td>\n   <td style=\"text-align:right;\"> 1.079482 </td>\n   <td style=\"text-align:right;\"> 15.91492 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 13.54291 </td>\n   <td style=\"text-align:right;\"> -0.0335147 </td>\n   <td style=\"text-align:right;\"> -0.0340889 </td>\n   <td style=\"text-align:right;\"> 0.0301641 </td>\n   <td style=\"text-align:right;\"> 0.0035574 </td>\n   <td style=\"text-align:right;\"> 1.081017 </td>\n   <td style=\"text-align:right;\"> 15.98166 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 13.91689 </td>\n   <td style=\"text-align:right;\"> -0.0436091 </td>\n   <td style=\"text-align:right;\"> -0.0505774 </td>\n   <td style=\"text-align:right;\"> 0.0263818 </td>\n   <td style=\"text-align:right;\"> 0.0043637 </td>\n   <td style=\"text-align:right;\"> 1.053566 </td>\n   <td style=\"text-align:right;\"> 15.75204 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 13.90655 </td>\n   <td style=\"text-align:right;\"> -0.0440917 </td>\n   <td style=\"text-align:right;\"> -0.0553922 </td>\n   <td style=\"text-align:right;\"> 0.0297604 </td>\n   <td style=\"text-align:right;\"> 0.0043289 </td>\n   <td style=\"text-align:right;\"> 1.025806 </td>\n   <td style=\"text-align:right;\"> 15.84069 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 13.78923 </td>\n   <td style=\"text-align:right;\"> -0.0493760 </td>\n   <td style=\"text-align:right;\"> -0.0417026 </td>\n   <td style=\"text-align:right;\"> 0.0296250 </td>\n   <td style=\"text-align:right;\"> 0.0042616 </td>\n   <td style=\"text-align:right;\"> 1.039411 </td>\n   <td style=\"text-align:right;\"> 16.03299 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_davion_2 |>\n  ggplot(aes(x = Davion_y)) +\n  stat_halfeye(.width = c(0.80, 0.98),\n               fill = bayes_col[\"posterior\"]) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile(posterior_davion_2$Davion_y, c(0.01, 0.99))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      1%      99% \n15.34616 16.28940 \n```\n:::\n:::\n\n\nThere is a 98% chance that the salary of a player with Davion Mitchell’s USG, MP, and GP is between $e^{15.35}$ and $e^{16.28}$ dollars.\n\nIn other words, there is a 98% chance that a player with Davion Mitchell's stats will have a predicted salary of 4,638,956 to 11,757,478 dollars. This seems more incorrect as Mitchell has a salary closer to 1 million dollars. Games played doesn't mean a player gets paid more, but this model will over predicted players who have been in a lot of games. Davion Mitchell is an outlier in terms of the games played.\n\n# Conclusion\n\nBased on the credible intervals we obtained, our model only using minutes played and usage rate produces a closer prediction to the actual salary values. After including games played in our model, our predictions fell further from the actual numbers. Although, we attempted to include more variables, our predictions became more off because these variables don't describe salary behavior as well.\n\nOne shortcoming we saw of our chosen model is that it isn't not highly descriptive and doesn't a describe the wide range of individual player statistics. For example is that certain players will have a lot of minutes played per game, has a high usage rate, but only one game played and not be paid over one million dollars. Their salary will be over predicted.\n\nThere is one point in Handout 27 Model Comparison that Professor Ross points out about a simple model versus a complex model. \"However, we don’t always want to just choose the more complex model. Always choosing the more complex model over fits the data.\" As we saw with our more complex model which included games played, it did over fit Davion Mitchell's salary significance, despite being considered what would be an average player with an average players stats. So for this analysis we focused on minutes played (MP) and usage rate (USG), since we believed salaries would be affected the most significantly by these statistics and would describe salaries within the data set the best.\n\nOne thing we considered while concluding this report is the popularity of each player that was not mentioned in this data set. Many increases in salaries include outside variables such as endorsements, brand deals, and other marketability each player has. Player statistics is one aspect of salary, but outside influence could have much more effect and should be furthered analyzed.\n\nRelating and concluding our research with the Bayesian perspective, we found that our Bayesian analysis was valuable in our context since the salaries of players are constantly changing every season. It would be inaccurate to state our parameters without looking at the data. This Bayesian analysis approach allowed us to account for the always-changing landscape of basketball salaries.\n\n# BRMS Untransformed Response Model\n\nDown below is our first model with no transformation. Although this model could be used, we found that a normal distribution in BRMS would've lead to an easier interpretation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_brms_prior_3 <- brm(data = nba_salary,\n           family = exponential(),\n           Salary ~ MP + USG.,\n           sample_prior = TRUE,\n           iter = 3500,\n           warmup = 1000,\n           chains = 4,\n           refresh = 0)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCompiling Stan program...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nStart sampling\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolor_scheme_set(\"viridis\")\n\npar(mfrow = c(2, 2))\nplot(fit_brms_prior_3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit_brms_prior_3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Family: exponential \n  Links: mu = log \nFormula: Salary ~ MP + USG. \n   Data: nba_salary (Number of observations: 467) \n  Draws: 4 chains, each with iter = 3500; warmup = 1000; thin = 1;\n         total post-warmup draws = 10000\n\nRegression Coefficients:\n          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nIntercept    13.36      0.16    13.03    13.68 1.00    10337     7969\nMP            0.09      0.01     0.08     0.10 1.00     7383     7840\nUSG.          0.02      0.01     0.00     0.04 1.00     6700     7152\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolor_scheme_set(\"purple\")\n\npp_check(fit_brms_prior_3, ndraw = 100)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\nSimilarly, simulated distributions follow a similar distribution with the actual curve. But again, the actual curve has some strange curves due to the salary.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit_brms_prior_3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Family: exponential \n  Links: mu = log \nFormula: Salary ~ MP + USG. \n   Data: nba_salary (Number of observations: 467) \n  Draws: 4 chains, each with iter = 3500; warmup = 1000; thin = 1;\n         total post-warmup draws = 10000\n\nRegression Coefficients:\n          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nIntercept    13.36      0.16    13.03    13.68 1.00    10337     7969\nMP            0.09      0.01     0.08     0.10 1.00     7383     7840\nUSG.          0.02      0.01     0.00     0.04 1.00     6700     7152\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}